train:
  seed: 42
  monitor: val_loss
  mode: min
  test: false
  validate_at_start: false
  pretrained_model_path: null
  pretrained_model_strict_load: true
  ckpt: null
  interval: epoch
wandb: null
trainer:
  _target_: pytorch_lightning.Trainer
  devices: 1
  accelerator: auto
  accumulate_grad_batches: 2
  max_epochs: 100
  gradient_clip_val: 1.0
  log_every_n_steps: 10
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  precision: 32
loader:
  batch_size: 200
  num_workers: 1
  pin_memory: true
  drop_last: false
data:
  data_dir: ${hydra:runtime.cwd}/data
  variants_file: variants_with_penetrance.common.all.with_info.feats.tsv
  reference_genome: hg38.ml.fa
  seq_len: 512
  center_on_variant: true
  annotation_columns:
  - gnomad41_AF
  - gnomad41_AF_afr
  - gnomad41_AF_eas
  - gnomad41_AF_nfe
  - gnomad41_AF_sas
  - GERP++_RS
  - phyloP100way
  - phastCons100way
  - phastCons17way
  - SIFT_score
  - SIFT4G_score
  - Polyphen2_HDIV_score
  - Polyphen2_HVAR_score
  - MetaSVM_score
  - MetaLR_score
  - MetaRNN_score
  - REVEL_score
  - AlphaMissense_score
  - ESM1b_score
  - PrimateAI_score
  - CADD_phred
  - VEST4_score
  - BayesDel_addAF_score
  - ClinPred_score
  - SpliceAI
  - DS_AG
  - DS_AL
  - DS_DG
  - DS_DL
  - EncodeH3K4me3-sum
  - EncodeH3K27ac-sum
  - EncodeDNase-sum
  - Dann_Phred
  - Fathmm_Mkl_Phred
  - Linsight_Phred
  - CLNSIG
  - CLNREVSTAT
  - case_frequency
  - control_frequency
  - SPARK_carriers
  - UKB_carriers
  - ClinPred_pred
  gene_columns:
  - pLI
  - LOEUF
  - mis_z
  - oe_lof
  - oe_mis
  - oe_syn
  - Astro_avg_exp
  - Excitatory_avg_exp
  - Inhibitory_avg_exp
  - Microglia_avg_exp
  - Oligodendrocyte_avg_exp
  - OPC_avg_exp
  - Vascular_avg_exp
  - GTEx_MEAN
  - CENTRAL_NERVOUS_SYSTEM_MEAN
  - BrainSpan_MEAN
  - DSI
  - DPI
  - GDI
  - HI_Score
  train_val_test_split:
  - 0.7
  - 0.15
  - 0.15
  batch_size: 512
model:
  _target_: src.models.penetrance_net.PenetranceNet
  hyena_pretrained_model: hyenadna-small-32k-seqlen
  use_pretrained: true
  freeze_hyena: false
  annotation_dim: 128
  gene_dim: 128
  hyena_output_dim: 256
  fusion_dim: 512
  fusion_blocks: 4
  fusion_activation: tanh
  output_dim: 1
  dropout_rate: 0.1
  annotation_columns: ${data.annotation_columns}
  gene_columns: ${data.gene_columns}
  optimizer: ${optimizer}
optimizer:
  _name_: adamw
  lr: 0.0001
  weight_decay: 0.01
  betas:
  - 0.9
  - 0.999
scheduler:
  _name_: plateau
  mode: min
  factor: 0.5
  patience: 5
callbacks:
  learning_rate_monitor:
    logging_interval: ${train.interval}
  timer:
    step: true
    inter_step: false
    epoch: true
    val: true
  params:
    total: true
    trainable: true
    fixed: true
  model_checkpoint:
    monitor: ${train.monitor}
    mode: ${train.mode}
    save_top_k: 3
    save_last: true
    dirpath: checkpoints/${now:%Y-%m-%d_%H-%M-%S}/
    filename: ${train.monitor}
    auto_insert_metric_name: false
    verbose: true
  early_stopping:
    monitor: ${train.monitor}
    mode: ${train.mode}
    patience: 10
    min_delta: 0
task:
  _name_: penetrance_prediction
  loss: mse
  metrics:
  - mse
