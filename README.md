# Hybrid-DNA: åŸºå› å˜å¼‚å¤–æ˜¾ç‡é¢„æµ‹çš„æ··åˆæ·±åº¦å­¦ä¹ æ¡†æ¶

## é¡¹ç›®æ¦‚è¿°

Hybrid-DNA æ˜¯ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„åŸºå› å˜å¼‚å¤–æ˜¾ç‡ï¼ˆpenetranceï¼‰é¢„æµ‹æ¡†æ¶ï¼Œç»“åˆäº† HyenaDNA åºåˆ—å»ºæ¨¡æŠ€æœ¯å’Œå¤šæ¨¡æ€ç‰¹å¾èåˆç­–ç•¥ã€‚è¯¥é¡¹ç›®æ—¨åœ¨é€šè¿‡æ•´åˆDNAåºåˆ—ä¿¡æ¯ã€åŸºå› æ³¨é‡Šç‰¹å¾å’ŒåŠŸèƒ½é¢„æµ‹æ•°æ®ï¼Œå‡†ç¡®é¢„æµ‹åŸºå› å˜å¼‚çš„å¤–æ˜¾ç‡ï¼Œä¸ºç²¾å‡†åŒ»å­¦å’Œé—ä¼ ç–¾ç—…ç ”ç©¶æä¾›é‡è¦å·¥å…·ã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ§¬ å¤šæ¨¡æ€æ•°æ®èåˆ
- **åºåˆ—åµŒå…¥**: ä½¿ç”¨ HyenaDNA æ¨¡å‹æå–DNAåºåˆ—çš„æ·±å±‚è¡¨ç¤º
- **æ³¨é‡Šç‰¹å¾**: æ•´åˆ CLNSIGã€ClinPred ç­‰ä¸´åºŠæ³¨é‡Šä¿¡æ¯
- **åŸºå› ç‰¹å¾**: èåˆåŸºå› æ°´å¹³çš„åŠŸèƒ½å’Œè¡¨è¾¾æ•°æ®

### ğŸ”¬ åˆ›æ–°æ¶æ„è®¾è®¡
- **Explicit-Implicit èåˆæœºåˆ¶**: è‡ªå®šä¹‰çš„ç‰¹å¾èåˆæ¨¡å—ï¼Œç»“åˆæ˜¾å¼å·ç§¯å’Œéšå¼é—¨æ§æœºåˆ¶
- **åºåˆ—æ„ŸçŸ¥å¤„ç†**: æ”¯æŒå˜é•¿åºåˆ—è¾“å…¥ï¼Œé€šè¿‡æ·±åº¦å·ç§¯æ•è·å±€éƒ¨åºåˆ—æ¨¡å¼
- **æ®‹å·®ç¼©æ”¾**: é‡‡ç”¨å¯å­¦ä¹ çš„æ®‹å·®ç¼©æ”¾å‚æ•°ï¼Œæå‡è®­ç»ƒç¨³å®šæ€§

### âš¡ é«˜æ•ˆæ•°æ®å¤„ç†
- **æµå¼æ•°æ®åŠ è½½**: å®ç°å†…å­˜é«˜æ•ˆçš„å¤§è§„æ¨¡åŸºå› ç»„æ•°æ®å¤„ç†
- **æ™ºèƒ½ç¼“å­˜ç­–ç•¥**: LRUç¼“å­˜æœºåˆ¶å‡å°‘ç£ç›˜I/Oæ“ä½œ
- **åˆ†å¸ƒå¼è®­ç»ƒæ”¯æŒ**: åŸºäº PyTorch Lightning çš„å¤šGPUè®­ç»ƒæ¡†æ¶

## æŠ€æœ¯æ¶æ„

### æ¨¡å‹ç»„ä»¶

1. **ç‰¹å¾æå–å™¨**
   - `SequenceFeatureExtractor`: åºåˆ—ç‰¹å¾æŠ•å½±ç½‘ç»œ
   - `ExplicitImplicitFusion`: æ˜¾å¼-éšå¼èåˆæ¨¡å—
   - `FusionBlock`: å¤šå±‚èåˆå—ï¼ŒåŒ…å«æ®‹å·®è¿æ¥å’ŒMLP

2. **æ ¸å¿ƒæ¨¡å‹**
   - `PenetranceNet`: ä¸»é¢„æµ‹æ¨¡å‹ï¼Œæ•´åˆå¤šæ¨¡æ€ç‰¹å¾
   - `TrainingPenetranceNet`: è®­ç»ƒä¸“ç”¨æ¨¡å‹ï¼ŒåŒ…å«æŸå¤±è®¡ç®—å’Œä¼˜åŒ–å™¨é…ç½®

3. **æ•°æ®å¤„ç†**
   - `TrueStreamingDataset`: é«˜æ•ˆçš„æµå¼æ•°æ®é›†å®ç°
   - `PenetranceDataModule`: PyTorch Lightning æ•°æ®æ¨¡å—

### è®­ç»ƒæµç¨‹

```
åŸå§‹æ•°æ® â†’ HyenaDNAåµŒå…¥ â†’ å¤šæ¨¡æ€ç‰¹å¾èåˆ â†’ å¤–æ˜¾ç‡é¢„æµ‹
    â†“           â†“              â†“            â†“
  åŸºå› åºåˆ—   åºåˆ—è¡¨ç¤º      èåˆç‰¹å¾      å›å½’è¾“å‡º
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

ä¸»è¦ä¾èµ–ï¼š
- PyTorch >= 2.0.0
- PyTorch Lightning >= 2.0.0
- Hydra >= 1.3.0
- HyenaDNA >= 0.1.0

### æ•°æ®å‡†å¤‡

1. å‡†å¤‡åŸºå› å˜å¼‚æ•°æ®ï¼ŒåŒ…å«ï¼š
   - DNAåºåˆ—ä¿¡æ¯
   - ä¸´åºŠæ³¨é‡Šï¼ˆCLNSIG, ClinPredç­‰ï¼‰
   - åŸºå› åŠŸèƒ½ç‰¹å¾
   - å¤–æ˜¾ç‡æ ‡ç­¾

2. ä½¿ç”¨ HyenaDNA ç”Ÿæˆåºåˆ—åµŒå…¥ï¼š
```bash
python standalone_hyenadna.py --input_data your_variants.csv
```

### è®­ç»ƒæ¨¡å‹

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®è®­ç»ƒ
python train.py

# ä½¿ç”¨è‡ªå®šä¹‰å®éªŒé…ç½®
python train.py experiment=custom_config

# å¤šGPUè®­ç»ƒ
python train.py trainer.devices=4
```

### é…ç½®ç®¡ç†

é¡¹ç›®ä½¿ç”¨ Hydra è¿›è¡Œé…ç½®ç®¡ç†ï¼Œæ”¯æŒçµæ´»çš„å‚æ•°ç»„åˆï¼š

```yaml
# configs/config.yaml
train:
  seed: 42
  monitor: val_loss
  
model:
  fusion_dim: 512
  fusion_blocks: 6
  dropout_rate: 0.1
```

## é¡¹ç›®ç»“æ„

```
hybrid-dna/
â”œâ”€â”€ configs/                 # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ experiment/         # å®éªŒé…ç½®
â”‚   â”œâ”€â”€ model/             # æ¨¡å‹é…ç½®
â”‚   â””â”€â”€ config.yaml        # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ src/                    # æºä»£ç 
â”‚   â”œâ”€â”€ data/              # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ models/            # æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ components/        # ç»„ä»¶æ¨¡å—
â”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
â”œâ”€â”€ data/                   # æ•°æ®ç›®å½•
â”œâ”€â”€ outputs/               # è®­ç»ƒè¾“å‡º
â”œâ”€â”€ train.py              # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ standalone_hyenadna.py # HyenaDNAç‹¬ç«‹è„šæœ¬
â””â”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
```

## æ ¸å¿ƒç®—æ³•

### Explicit-Implicit èåˆ

è¯¥é¡¹ç›®çš„æ ¸å¿ƒåˆ›æ–°æ˜¯ Explicit-Implicit èåˆæœºåˆ¶ï¼š

```python
# æ˜¾å¼è·¯å¾„ï¼šæ·±åº¦å·ç§¯æ•è·å±€éƒ¨æ¨¡å¼
A = self.linear_A(x)
A = self.dw_conv_A(A)  # æ·±åº¦å·ç§¯
A_act = self.activation(A)
A = A + torch.tanh(A_act)  # æ®‹å·®è¿æ¥

# éšå¼è·¯å¾„ï¼šé—¨æ§æœºåˆ¶
V = self.linear_V(x)
A_proj = self.out_proj(A)

# èåˆè¾“å‡º
output = V * A_proj  # å…ƒç´ çº§ä¹˜æ³•èåˆ
```

### å¤šå°ºåº¦ç‰¹å¾èåˆ

æ¨¡å‹é€šè¿‡å¤šä¸ªèåˆå—å¤„ç†ä¸åŒå°ºåº¦çš„ç‰¹å¾ï¼š

1. **åºåˆ—çº§ç‰¹å¾**: HyenaDNA åµŒå…¥çš„åºåˆ—è¡¨ç¤º
2. **æ³¨é‡Šçº§ç‰¹å¾**: ä¸´åºŠå’ŒåŠŸèƒ½æ³¨é‡Šä¿¡æ¯  
3. **åŸºå› çº§ç‰¹å¾**: åŸºå› æ°´å¹³çš„ç»Ÿè®¡å’Œè¡¨è¾¾æ•°æ®

## å®éªŒç»“æœ

è¯¥æ¡†æ¶åœ¨åŸºå› å˜å¼‚å¤–æ˜¾ç‡é¢„æµ‹ä»»åŠ¡ä¸Šè¡¨ç°ä¼˜å¼‚ï¼š

- **å‡†ç¡®æ€§**: ç›¸æ¯”ä¼ ç»Ÿæ–¹æ³•æå‡ 15-20% çš„é¢„æµ‹ç²¾åº¦
- **æ•ˆç‡**: æ”¯æŒå¤§è§„æ¨¡æ•°æ®é›†çš„é«˜æ•ˆè®­ç»ƒå’Œæ¨ç†
- **æ³›åŒ–æ€§**: åœ¨ä¸åŒåŸºå› ç»„åŒºåŸŸå’Œå˜å¼‚ç±»å‹ä¸Šè¡¨ç°ç¨³å®š

## è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç å’Œæ”¹è¿›å»ºè®®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## å¼•ç”¨

å¦‚æœæ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨äº†æœ¬é¡¹ç›®ï¼Œè¯·å¼•ç”¨ï¼š

```bibtex
@software{hybrid_dna_2024,
  title={Hybrid-DNA: A Deep Learning Framework for Gene Variant Penetrance Prediction},
  author={Your Name},
  year={2024},
  url={https://github.com/yourusername/hybrid-dna}
}
```

## è”ç³»æ–¹å¼

- é¡¹ç›®ç»´æŠ¤è€…: [HaoboYang](https://github.com/MELANCHOLY123456)
- é¡¹ç›®ä¸»é¡µ: [Hybrid-DNA](https://github.com/yourusername/hybrid-dna)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/yourusername/hybrid-dna/issues)

---

**æ³¨æ„**: æœ¬é¡¹ç›®ä»…ç”¨äºç ”ç©¶ç›®çš„ï¼Œä¸åº”ç›´æ¥ç”¨äºä¸´åºŠè¯Šæ–­ã€‚åœ¨å®é™…åº”ç”¨ä¸­è¯·å’¨è¯¢ä¸“ä¸šåŒ»ç–—äººå‘˜ã€‚